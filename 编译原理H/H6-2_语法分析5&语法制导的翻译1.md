# H6-2 语法分析 5&语法制导的翻译 1

PB20000180 刘良宇

## 3.31

下面两个文法中哪一个不是 LR(1) 文法，并对非 LR(1) 的那个文法给出含有移进 - 归约冲突的规范的 LR(1) 项目集。

1)$S\rarr aAc$ $A\rarr Abb∣b$

2)$S\rarr aAc$ $A\rarr bAb∣b$

第二个文法不是 LR(1) 文法。

首先为产生式编号：

$$
\begin{align*}
0&: S' \rarr S\\
1&: S \rarr a A c\\
2&: A \rarr b A b\\
3&: A \rarr b
\end{align*}
$$

据此：

<table border="1"><thead><tr><th colspan="4">LR(1) closure table</th></tr><tr><th>Goto</th><th>State</th><th>Closure</th></tr></thead><tbody id="lrClosureTableRows"><tr><td></td><td style="color: blue;">0</td><td>{[S' -&gt; .S, $]<br>[S -&gt; .a A c, $]}</td></tr><tr><td>goto(0, S)</td><td style="color: blue;">1</td><td>{<span style="color: green;">[S' -&gt; S., $]</span>}</td></tr><tr><td>goto(0, a)</td><td style="color: blue;">2</td><td>{[S -&gt; a.A c, $]<br>[A -&gt; .b A b, c]<br>[A -&gt; .b, c]}</td></tr><tr><td>goto(2, A)</td><td style="color: blue;">3</td><td>{[S -&gt; a A.c, $]}</td></tr><tr><td>goto(2, b)</td><td style="color: blue;">4</td><td>{[A -&gt; b.A b, c]<br><span style="color: green;">[A -&gt; b., c]</span><br>[A -&gt; .b A b, b]<br>[A -&gt; .b, b]}</td></tr><tr><td>goto(3, c)</td><td style="color: blue;">5</td><td>{<span style="color: green;">[S -&gt; a A c., $]</span>}</td></tr><tr><td>goto(4, A)</td><td style="color: blue;">6</td><td>{[A -&gt; b A.b, c]}</td></tr><tr><td>goto(4, b)</td><td style="color: blue;">7</td><td>{[A -&gt; b.A b, b]<br><span style="color: green;">[A -&gt; b., b]</span><br>[A -&gt; .b A b, b]<br>[A -&gt; .b, b]}</td></tr><tr><td>goto(6, b)</td><td style="color: blue;">8</td><td>{<span style="color: green;">[A -&gt; b A b., c]</span>}</td></tr><tr><td>goto(7, A)</td><td style="color: blue;">9</td><td>{[A -&gt; b A.b, b]}</td></tr><tr><td>goto(7, b)</td><td style="color: blue;">7</td><td>&nbsp;</td></tr><tr><td>goto(9, b)</td><td style="color: blue;">10</td><td>{<span style="color: green;">[A -&gt; b A b., b]</span>}</td></tr></tbody></table>

对于第 7 个状态，若读入 $b$，移进 - 规约冲突的产生

- 根据 $\{A\rarr .b,b\}$ 移进，$action[7,b] = s_7$
- 根据 $\{A\rarr b., b\}$ 规约，$action[7,b] = r_3$

## 4.3

为文法

$$
\begin{align*}
S&→(L) ∣ a\\
L&→L,S ∣ S
\end{align*}
$$

(a) 写一个语法制导定义，它输出括号的对数。

(b) 写一个语法制导定义，它输出括号嵌套的最大深度。

### 输出括号对数

$$
\begin{align*}
S' &\rarr S &print(S.n)\\
S &\rarr (L) &S.n = L.n + 1\\
S &\rarr a &S.n = 0\\
L &\rarr L_1,S &L.n = L_1.n + S.n\\
L &\rarr S &L.n = S.n
\end{align*}
$$

### 输出括号嵌套的最大深度

$$
\begin{align*}
S' &\rarr S &print(S.n)\\
S &\rarr (L) &S.n = L.n + 1\\
S &\rarr a &S.n = 0\\
L &\rarr L_1,S &L.n = max(L_1.n, S.n)\\
L &\rarr S &L.n = S.n
\end{align*}
$$
